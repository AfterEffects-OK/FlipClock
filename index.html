
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Retro Flip Clock</title>
    <script>
        tailwind.config = {
            darkMode: 'class',
        }
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- 常に表示するコントロール（フルスクリーンと設定トグル） -->
    <div class="top-controls">
        <!-- 設定パネル開閉ボタン (歯車アイコン) -->
        <button class="btn-icon" id="toggle-settings" aria-label="設定を開く">
            <i class="fas fa-cog"></i>
        </button>
        <!-- フルスクリーン制御ボタン (常に表示) -->
        <button class="btn-icon" id="toggle-fs" onclick="toggleFullScreen()" aria-label="フルスクリーン切り替え">
            <i class="fas fa-expand"></i>
        </button>
    </div>

    <div class="clock-and-settings-container">
        <!-- Content Row: Clock and Weather -->
        <div class="content-row" id="content-row">
        <div class="time-wrapper">
            <!-- Date Display -->
            <div class="date-display">
                <!-- Year -->
                <div class="group" data-label="Year">
                    <div class="card date-digit" id="d-year-tens"><div class="top"><span>0</span></div><div class="bottom"><span>0</span></div><div class="top-flip"><span>0</span></div><div class="bottom-flip"><span>0</span></div></div>
                    <div class="card date-digit" id="d-year-ones"><div class="top"><span>0</span></div><div class="bottom"><span>0</span></div><div class="top-flip"><span>0</span></div><div class="bottom-flip"><span>0</span></div></div>
                </div>

                <div class="date-separator">/</div>

                <!-- Month -->
                <div class="group" data-label="Month">
                    <div class="card date-digit" id="d-month-tens"><div class="top"><span>0</span></div><div class="bottom"><span>0</span></div><div class="top-flip"><span>0</span></div><div class="bottom-flip"><span>0</span></div></div>
                    <div class="card date-digit" id="d-month-ones"><div class="top"><span>0</span></div><div class="bottom"><span>0</span></div><div class="top-flip"><span>0</span></div><div class="bottom-flip"><span>0</span></div></div>
                </div>

                <div class="date-separator">/</div>

                <!-- Day -->
                <div class="group" data-label="Day">
                    <div class="card date-digit" id="d-day-tens"><div class="top"><span>0</span></div><div class="bottom"><span>0</span></div><div class="top-flip"><span>0</span></div><div class="bottom-flip"><span>0</span></div></div>
                    <div class="card date-digit" id="d-day-ones"><div class="top"><span>0</span></div><div class="bottom"><span>0</span></div><div class="top-flip"><span>0</span></div><div class="bottom-flip"><span>0</span></div></div>
                </div>
                
                <!-- Day of Week (New Flip Card Structure) -->
                <div class="day-of-week-group">
                    <div class="card dow-digit" id="dow-char1"><div class="top"><span>(</span></div><div class="bottom"><span>(</span></div><div class="top-flip"><span>(</span></div><div class="bottom-flip"><span>(</span></div></div>
                    <div class="card dow-digit" id="dow-char2"><div class="top"><span>水</span></div><div class="bottom"><span>水</span></div><div class="top-flip"><span>水</span></div><div class="bottom-flip"><span>水</span></div></div>
                    <div class="card dow-digit" id="dow-char3"><div class="top"><span>)</span></div><div class="bottom"><span>)</span></div><div class="top-flip"><span>)</span></div><div class="bottom-flip"><span>)</span></div></div>
                </div>
            </div>
            <!-- End Date Display -->

            <div class="clock">
                <!-- Hours -->
                <div class="group" data-label="Hours">
                    <div class="card time-digit" id="h-tens"><div class="top"><span>0</span></div><div class="bottom"><span>0</span></div><div class="top-flip"><span>0</span></div><div class="bottom-flip"><span>0</span></div></div>
                    <div class="card time-digit" id="h-ones"><div class="top"><span>0</span></div><div class="bottom"><span>0</span></div><div class="top-flip"><span>0</span></div><div class="bottom-flip"><span>0</span></div></div>
                </div>

                <div class="separator">:</div>

                <!-- Minutes -->
                <div class="group" data-label="Minutes">
                    <div class="card time-digit" id="m-tens"><div class="top"><span>0</span></div><div class="bottom"><span>0</span></div><div class="top-flip"><span>0</span></div><div class="bottom-flip"><span>0</span></div></div>
                    <div class="card time-digit" id="m-ones"><div class="top"><span>0</span></div><div class="bottom"><span>0</span></div><div class="top-flip"><span>0</span></div><div class="bottom-flip"><span>0</span></div></div>
                </div>

                <div class="separator">:</div>

                <!-- Seconds -->
                <div class="group" data-label="Seconds">
                    <div class="card time-digit" id="s-tens"><div class="top"><span>0</span></div><div class="bottom"><span>0</span></div><div class="top-flip"><span>0</span></div><div class="bottom-flip"><span>0</span></div></div>
                    <div class="card time-digit" id="s-ones"><div class="top"><span>0</span></div><div class="bottom"><span>0</span></div><div class="top-flip"><span>0</span></div><div class="bottom-flip"><span>0</span></div></div>
                </div>
            </div>
        </div>

        <!-- Weather Widget -->
        <div class="weather-scope dark" id="weather-widget-container">
            <!-- Refresh Button (Fixed position relative to container) -->
            <button id="refreshBtn" class="absolute right-2 z-10 p-1.5 rounded-full hover:bg-black/5 dark:hover:bg-white/10 transition-colors text-slate-400">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                </svg>
            </button>

            <div class="carousel-wrapper">
                <div class="carousel-track" id="carousel-track">
                    <!-- Slide 0: Weather -->
                    <div class="carousel-slide" id="slide-weather" data-icon="fas fa-cloud-sun">
                        <!-- Status display -->
                        <div id="loading" class="hidden text-center py-20">
                            <div class="text-2xl font-black text-slate-300 dark:text-slate-700 loading-dots">FETCHING</div>
                        </div>

                        <div id="errorMessage" class="hidden text-center p-6 bg-white dark:bg-slate-900 rounded-xl text-red-400 font-bold uppercase tracking-widest text-sm">
                            Connection Error
                        </div>

                        <div id="weather-content" class="space-y-1">
                            <!-- Today's Main Widget -->
                            <div id="todayCard"></div>
                            
                            <!-- 5-Day Forecast List Container -->
                            <div>
                                <div id="forecastList" class="space-y-1"></div>
                                <!-- Last Sync Info -->
                                <div id="syncTime" class="text-center text-[9px] font-bold text-slate-400 dark:text-slate-600 uppercase tracking-[0.2em] mt-1 pb-2"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Slide 1: RSS News -->
                    <div class="carousel-slide" id="slide-rss" data-icon="fas fa-newspaper">
                        <div id="rss-loading" class="hidden text-center py-20">
                            <div class="text-2xl font-black text-slate-300 dark:text-slate-700 loading-dots">NEWS</div>
                        </div>
                        <div id="rss-error" class="hidden text-center p-6 text-red-400 font-bold uppercase tracking-widest text-sm">
                            Feed Error
                        </div>
                        <div id="rss-content">
                            <!-- List View -->
                            <div id="rss-list-view" class="h-full flex flex-col">
                                <div class="minimal-card p-2 px-3 mb-0 flex flex-col items-center shrink-0">
                                    <div class="text-[10px] font-[900] opacity-80 tracking-[0.6em] uppercase text-center w-full ml-[0.6em]">NEWS</div>
                                </div>
                                <div id="rss-list" class="flex-1 space-y-1"></div>
                            </div>

                            <!-- Detail View -->
                            <div id="rss-detail-view" class="hidden absolute inset-0 bg-[var(--weather-bg)] z-10 flex flex-col h-full">
                                <div class="minimal-card py-0 px-2 mb-0 flex items-center shrink-0">
                                     <button id="rss-back-btn" class="mr-3 text-slate-400 hover:text-blue-500 transition-colors p-0.5">
                                        <i class="fas fa-arrow-left text-xs"></i>
                                     </button>
                                     <div class="text-[10px] font-[900] opacity-80 tracking-[0.6em] uppercase text-center flex-1 mr-6">TOPIC</div>
                                </div>
                                <div class="minimal-card p-3 flex-1 flex flex-col overflow-hidden relative">
                                    <div class="flex-1 overflow-y-auto scrollbar-hide pb-20">
                                        <div id="rss-detail-title" class="text-sm font-black mb-1 leading-snug"></div>
                                        <div id="rss-detail-date" class="text-[10px] text-slate-400 mb-1 border-b border-slate-100 dark:border-slate-800 pb-1"></div>
                                        <div id="rss-detail-desc" class="text-xs opacity-90 leading-relaxed whitespace-pre-wrap font-medium"></div>
                                        <div class="mt-4 mb-2 text-center">
                                            <a id="rss-detail-link" href="#" target="_blank" class="inline-block px-4 py-2 bg-slate-100 dark:bg-slate-800 rounded-full text-xs font-bold text-blue-500 hover:text-blue-600 transition-colors">Read Article</a>
                                        </div>
                                    </div>
                                    <img id="rss-detail-qr" class="absolute bottom-3 right-3 w-14 h-14 bg-white p-1 rounded-md shadow-sm z-20" alt="QR Code">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Slide 2: Settings -->
                    <div class="carousel-slide" id="slide-settings" data-icon="fas fa-cog">
                        <div class="h-full flex flex-col">
                             <div class="minimal-card p-2 px-3 mb-0 flex flex-col items-center shrink-0">
                                <div class="text-[10px] font-[900] opacity-80 tracking-[0.6em] uppercase text-center w-full ml-[0.6em]">SETTINGS</div>
                            </div>
                            <div class="flex-1 overflow-y-auto p-1 space-y-2 scrollbar-hide">
                                <!-- Group 1: Clock Settings -->
                                <div class="minimal-card p-3 flex flex-col gap-2">
                                    <div class="text-[10px] font-bold opacity-60 mb-1">CLOCK</div>
                                    <div class="controls justify-between w-full">
                                        <button class="btn active flex-1 justify-center" id="mode-24">24H</button>
                                        <button class="btn flex-1 justify-center" id="mode-12">12H</button>
                                    </div>
                                    <div class="controls justify-between w-full">
                                        <button class="btn active flex-1 justify-center" id="lang-ja">日本語</button>
                                        <button class="btn flex-1 justify-center" id="lang-en">English</button>
                                    </div>
                                </div>

                                <!-- Group 2: Theme -->
                                <div class="minimal-card p-3 flex flex-col gap-2">
                                    <div class="text-[10px] font-bold opacity-60 mb-1">THEME</div>
                                    <div class="theme-controls justify-between w-full p-0 m-0">
                                        <button class="btn active theme-btn flex-1 justify-center" data-theme="dark" id="theme-dark">黒</button>
                                        <button class="btn theme-btn flex-1 justify-center" data-theme="light" id="theme-light">白</button>
                                        <button class="btn theme-btn flex-1 justify-center" data-theme="transparent" id="theme-transparent">透明</button>
                                    </div>
                                    <div class="custom-color-group w-full">
                                        <input type="color" id="custom-color-picker" value="#3a3a3a">
                                        <button class="btn theme-btn flex-1 justify-center" data-theme="custom" id="theme-custom">カスタム</button>
                                    </div>
                                </div>

                                <!-- Group 3: Weather/RSS -->
                                <div class="minimal-card p-3 flex flex-col gap-2">
                                    <div class="text-[10px] font-bold opacity-60 mb-1">AREA & RSS</div>
                                    <div class="weather-controls w-full m-0">
                                        <select id="areaSelect" class="settings-select w-full max-w-none">
                                            <optgroup label="Hokkaido & Tohoku"><option value="016000">HOKKAIDO</option><option value="020000">AOMORI</option><option value="030000">IWATE</option><option value="040000">MIYAGI</option><option value="050000">AKITA</option><option value="060000">YAMAGATA</option><option value="070000">FUKUSHIMA</option></optgroup>
                                            <optgroup label="Kanto"><option value="080000">IBARAKI</option><option value="090000">TOCHIGI</option><option value="100000">GUNMA</option><option value="110000">SAITAMA</option><option value="120000">CHIBA</option><option value="130000" selected>TOKYO</option><option value="140000">KANAGAWA</option></optgroup>
                                            <optgroup label="Chubu"><option value="150000">NIIGATA</option><option value="160000">TOYAMA</option><option value="170000">ISHIKAWA</option><option value="180000">FUKUI</option><option value="190000">YAMANASHI</option><option value="200000">NAGANO</option><option value="210000">GIFU</option><option value="220000">SHIZUOKA</option><option value="230000">AICHI</option></optgroup>
                                            <optgroup label="Kansai"><option value="240000">MIE</option><option value="250000">SHIGA</option><option value="260000">KYOTO</option><option value="270000">OSAKA</option><option value="280000">HYOGO</option><option value="290000">NARA</option><option value="300000">WAKAYAMA</option></optgroup>
                                            <optgroup label="Chugoku"><option value="310000">TOTTORI</option><option value="320000">SHIMANE</option><option value="330000">OKAYAMA</option><option value="340000">HIROSHIMA</option><option value="350000">YAMAGUCHI</option></optgroup>
                                            <optgroup label="Shikoku"><option value="360000">TOKUSHIMA</option><option value="370000">KAGAWA</option><option value="380000">EHIME</option><option value="390000">KOCHI</option></optgroup>
                                            <optgroup label="Kyushu & Okinawa"><option value="400000">FUKUOKA</option><option value="410000">SAGA</option><option value="420000">NAGASAKI</option><option value="430000">KUMAMOTO</option><option value="440000">OITA</option><option value="450000">MIYAZAKI</option><option value="460100">KAGOSHIMA</option><option value="471000">OKINAWA</option></optgroup>
                                        </select>
                                    </div>
                                    <div class="weather-controls w-full m-0 flex-col items-start">
                                        <label for="rss-url" style="font-size: 0.7rem; color: #999; margin-bottom: 0.2rem;">RSS URL</label>
                                        <input type="text" id="rss-url" class="settings-input w-full" placeholder="https://...">
                                    </div>
                                </div>

                                <!-- Group 4: Size -->
                                <div class="minimal-card p-3 flex flex-col gap-2">
                                    <div class="text-[10px] font-bold opacity-60 mb-1">SIZE</div>
                                    <div class="size-controls w-full p-0 m-0 justify-between max-w-none">
                                        <div class="custom-slider" id="size-slider">
                                            <div class="slider-track"></div>
                                            <div class="slider-thumb"></div>
                                        </div>
                                    </div>
                                    <button class="btn btn-action w-full justify-center mt-1" id="reset-size-btn">リセット</button>
                                </div>
                                
                                <!-- Group 5: Plugins -->
                                <div class="minimal-card p-3 flex flex-col gap-2">
                                    <div class="text-[10px] font-bold opacity-60 mb-1">PLUGINS</div>
                                    <div id="plugin-list" class="flex flex-col gap-1 mb-1"></div>
                                    <div id="plugin-drop-zone" class="border-2 border-dashed border-slate-300 dark:border-slate-700 rounded-lg p-4 text-center cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors">
                                        <div class="text-xs text-slate-400 pointer-events-none">
                                            <i class="fas fa-cloud-upload-alt mb-1 text-lg"></i><br>
                                            Drop .js file here
                                        </div>
                                    </div>
                                    <button class="btn btn-action w-full justify-center mt-1 text-xs" onclick="if(confirm('Delete all plugins?')) { localStorage.removeItem('flipClockUserPlugins'); location.reload(); }">Clear All Plugins</button>
                                </div>

                                <!-- Spacer for bottom scrolling -->
                                <div class="h-4"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pagination Dots -->
            <div class="carousel-dots" id="carousel-dots"></div>
        </div>
        </div> <!-- End of content-row -->
    </div>

    <div class="footer-text">RETRO FLIP CLOCK</div>

    <script src="script.js"></script>
</body>
</html>
